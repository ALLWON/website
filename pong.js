var ball,started=!1;function start(){started=!0,loop()}function setup(){ellipseMode(CENTER),createCanvas(windowWidth,windowHeight),noStroke(),ai=new Paddle(!1),player=new Paddle(!0),ball=new Ball(Math.random()*windowWidth,Math.random()*windowHeight),walls=selectAll(".none"),console.log(walls),walls=walls.map(t=>new Wall(t))}var activeAnims=0;function draw(){started&&(background(140,210,125,50),walls.forEach(t=>t.update(),this),ball.update(),player.update(),ai.update(),walls.forEach(t=>t.draw(),this),ball.draw(),ai.draw(),player.draw(),activeAnims>0&&console.log("drawing"))}class Wall{constructor(t){this.el=t,this.x=this.el.elt.getBoundingClientRect().x-5,this.y=this.el.elt.getBoundingClientRect().y-5,this.w=this.el.elt.getBoundingClientRect().width+10,this.h=this.el.elt.getBoundingClientRect().height+10,this.el.elt.addEventListener("transitionstart",()=>{activeAnims++}),this.el.elt.addEventListener("transitionend",()=>{activeAnims--})}update(){activeAnims>0&&this.reorient()}draw(){}handleResize(){this.reorient()}reorient(){this.x=this.el.elt.getBoundingClientRect().x-5,this.y=this.el.elt.getBoundingClientRect().y-5,this.w=this.el.elt.getBoundingClientRect().width+10,this.h=this.el.elt.getBoundingClientRect().height+10}}class Paddle{constructor(t){this.isPlayer=t,this.pos={x:width/2,y:0},this.pos.y=this.isPlayer?height-15:15,this.size={w:80,h:10}}handleResize(){this.pos.y=this.isPlayer?height-15:15}update(){this.pos.x=this.isPlayer?mouseX:ball.pos.x}draw(){stroke(1),rectMode(CENTER),stroke("#ff1654"),noFill(),rect(this.pos.x,this.pos.y,this.size.w,this.size.h)}}class Ball{constructor(t,s){this.pos={x:t,y:s},this.speed={x:7,y:-5},this.size=10,this.bounds={top:this.size/2+20,left:this.size/2,right:width-this.size/2,bottom:height-this.size/2}}handleResize(){this.bounds.right=width-this.size/2,this.bounds.bottom=height-this.size/2}update(){this.pos.x+=this.speed.x,this.pos.y+=this.speed.y,this.checkWalls(),this.checkPaddle(),walls.forEach((t,s)=>{this.pos.x>=t.x&&this.pos.x<=t.x+t.w&&this.pos.y>=t.y&&this.pos.y<=t.y+t.h&&(this.speed.y*=-1)},this)}checkPaddle(){this.pos.y>height-15-this.size/2&&this.pos.x>=player.pos.x-player.size.w/2&&this.pos.x<=player.pos.x+player.size.w/2&&(this.pos.y=height-15-this.size/2,this.speed.y*=-1,fill("#00FF00"))}checkWalls(){(this.pos.x<=this.bounds.left||this.pos.x>=this.bounds.right)&&(this.pos.x=this.pos.x<=this.bounds.left?this.bounds.left:this.bounds.right,this.speed.x*=-1),(this.pos.y<=this.bounds.top||this.pos.y>=this.bounds.bottom)&&(this.pos.y=this.pos.y<=this.bounds.top?this.bounds.top:height/2,this.speed.y*=-1)}draw(){noStroke(),fill("#eeef20"),ellipse(this.pos.x,this.pos.y,this.size,this.size)}}function windowResized(){resizeCanvas(windowWidth,windowHeight),ball.handleResize(),player.handleResize(),walls.forEach(t=>t.reorient(),this)}
